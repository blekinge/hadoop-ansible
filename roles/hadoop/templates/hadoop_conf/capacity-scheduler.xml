{{ ansible_managed | comment('xml') }}
<configuration>

    <property>
        <name>yarn.scheduler.capacity.maximum-am-resource-percent</name>
        <value>0.1</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.maximum-applications</name>
        <value>10000</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.node-locality-delay</name>
        <value>40</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.queue-mappings</name>
        <value>{{queue_mappings | default([]) | join(',')}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.queue-mappings-override.enable</name>
        <value>false</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.resource-calculator</name>
        <value>org.apache.hadoop.yarn.util.resource.DominantResourceCalculator</value>
    </property>


    <property>
        <name>yarn.scheduler.capacity.per-node-heartbeat.multiple-assignments-enabled</name>
        <value>true</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.per-node-heartbeat.maximum-container-assignments</name>
        <value>10</value>
    </property>



    <property>
        <name>yarn.scheduler.capacity.root.accessible-node-labels</name>
        <value>*</value>
    </property>

    {% for queue in capacity_queues %}
   <!-- {{ queue }} -->
    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.acl_administer_queue</name>
        <value>{{queue.admins | default('')}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.acl_submit_applications</name>
        <value>{{queue.submitters | default('')}}</value>
    </property>


    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.capacity</name>
        <value>{{queue.capacity | default(100)}}</value>
    </property>
    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.maximum-capacity</name>
        <value>{{queue.max_capacity | default(100)}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.ordering-policy</name>
        <value>{{queue.ordering | default('fifo')}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.priority</name>
        <value>{{queue.priority | default(0)}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.queues</name>
        <value>{{queue.subqueues | default('')}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.state</name>
        <value>{{queue.state | default('RUNNING')}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.minimum-user-limit-percent</name>
        <value>{{queue.minimum_user_limit | default(25)}}</value>
    </property>

    <property>
        <name>yarn.scheduler.capacity.{{queue.longname}}.ordering-policy.fair.enable-size-based-weight</name>
        <value>{{queue.size_based | default('false')}}</value>
    </property>
    <!-- End queue {{queue.longname}} -->



    {% endfor %}




</configuration>
